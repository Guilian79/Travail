{"version":3,"file":"undernet.bundle.min.js","sources":["../src/js/helpers/constants.js","../src/js/helpers/dom.js","../src/js/helpers/is-browser-env.js","../src/js/helpers/component-engine.js","../src/js/helpers/log.js","../src/js/helpers/create-focus-trap.js","../src/js/helpers/focus-once.js","../src/js/helpers/is-ios-mobile.js","../src/js/collapsible/constants.js","../src/js/collapsible/collapsible.js","../src/js/helpers/throttle.js","../src/js/dropdown/constants.js","../src/js/dropdown/dropdown.js","../src/js/modal/constants.js","../src/js/modal/modal.js","../src/js/tooltip/constants.js","../src/js/tooltip/tooltip.js","../src/js/index.js","../src/js/helpers/create-focus-ring.js","../src/js/index.bundle.js"],"sourcesContent":["export const KeyCodes = {\n  SHIFT: 16,\n  TAB: 9,\n  ARROW_UP: 38,\n  ARROW_DOWN: 40,\n}\n\nexport const Selectors = {\n  FOCUSABLE_TAGS: [\"a\", \"button\", \"input\", \"object\", \"select\", \"textarea\", \"[tabindex]\"],\n  KEYBOARD_CLASS: \"using-keyboard\",\n  NOT_VISUALLY_HIDDEN_CLASS: \":not(.is-visually-hidden)\",\n  TABINDEX: \"tabindex\",\n}\n\nexport const Events = {\n  KEYDOWN: \"keydown\",\n  CLICK: \"click\",\n  BLUR: \"blur\",\n}\n\nexport const Messages = {\n  NO_SELECTOR_STRING_OR_CHILDREN_ERROR:\n    \"createFocusTrap must be given one or both of: first parameter (as selector string)\" +\n    \" and/or options.children (array of elements).\",\n  OPTION_MATCHERS_DATA_TYPE_ERROR:\n    \"Invalid data type given to options.matchers for createFocusTrap. Expected: Array.\",\n  INCORRECT_MATCHER_TYPE_ERROR: type =>\n    `Invalid matcher given to options.matchers for createFocusTrap. Expected: String. Recieved: ${type}.`,\n  NO_MATCHER_LENGTH_ERROR:\n    \"Invalid value given to options.matchers for createFocusTrap; value must be an array with at least one selector string\",\n}\n","import { Selectors } from \"./constants\"\n\n/**\n * Run a `querySelectorAll` but convert the result to an array literal for IE11 compat.\n * @param {string} selector\n * @param {HTMLElement} parent\n */\nexport const queryAll = (selector, parent = document) => {\n  return Array.apply(null, parent.querySelectorAll(selector))\n}\n\n/**\n * Search for elements matching a given selector.\n *\n * ```js\n * const elements = getFocusableElements(\".wrapper\")\n * elements.forEach(element => element.classList.add(\"focusable\"))\n * ```\n *\n * Use a custom pattern to select only specific elements:\n *\n * ```js\n * const elements = getFocusableElements(\".wrapper\", [\".my-button\"])\n * ```\n *\n * @param {String} selectorString - The selector string of the container element.\n * @param {String[]} matchers - Optional matchers override. Defaults to common focusable selectors.\n * @returns {Element[]} Static array of HTML elements\n */\nexport const getFocusableElements = (selectorString, matchers = Selectors.FOCUSABLE_TAGS) => {\n  const focusables = matchers\n    .map(selector => `${selectorString} ${selector}${Selectors.NOT_VISUALLY_HIDDEN_CLASS}`)\n    .join(\", \")\n\n  return queryAll(focusables)\n}\n","/**\n * Check if window exists. If it doesn't, we're probably in a non-test node environment.\n */\nexport const isBrowserEnv = typeof window !== \"undefined\"\n","import { queryAll } from \"./dom\"\nimport { isBrowserEnv } from \"./is-browser-env\"\n\nconst isString = value => typeof value === \"string\"\nconst isFunction = value => typeof value === \"function\"\n\nexport const ComponentEngine = {\n  /**\n   * Initialize an Undernet component globally or by id.\n   * @param {Object} metadata\n   * @property {string} id\n   * @property {string} attribute\n   * @property {Object} thisArg\n   */\n  start: (metadata = {}) => {\n    if (!isBrowserEnv) return\n\n    const { id, attribute, thisArg } = metadata\n\n    if (id && isString(id)) {\n      const instance = document.querySelector(`[${attribute}='${id}']`)\n      if (!instance) return\n\n      const validComponent = [instance].filter(thisArg._validate)[0]\n      if (!validComponent) return\n\n      thisArg._components.push(validComponent)\n    } else if (!id && !thisArg._components.length) {\n      const instances = queryAll(`[${attribute}]`)\n      if (!instances.length) return\n\n      const validComponents = instances.filter(thisArg._validate)\n      thisArg._components = thisArg._components.concat(validComponents)\n    } else {\n      // attempted to .start() when .stop() wasn't run,\n      // OR tried to instantiate a component that's already active.\n    }\n  },\n  /**\n   * Teardown an Undernet component globally or by id.\n   * @param {Object} metadata\n   * @property {string} id\n   * @property {string} attribute\n   * @property {Object} thisArg\n   * @property {string} activeNodeKey\n   * @property {*=} cancelActiveFn\n   */\n  stop: (metadata = {}) => {\n    if (!isBrowserEnv) return\n\n    const { id, attribute, thisArg, activeNodeKey, cancelActiveFn } = metadata\n\n    if (id && isString(id)) {\n      let targetIndex\n      const instance = thisArg._components.filter((activeInstance, index) => {\n        if (activeInstance.getAttribute(attribute) !== id) return false\n        targetIndex = index\n        return true\n      })[0]\n\n      if (!instance) return\n\n      if (\n        thisArg[activeNodeKey] &&\n        instance === thisArg[activeNodeKey] &&\n        isFunction(cancelActiveFn)\n      )\n        thisArg[cancelActiveFn]()\n\n      thisArg._teardown(instance)\n      thisArg._components.splice(targetIndex, 1)\n    } else if (!id && thisArg._components.length) {\n      if (thisArg[activeNodeKey] && isFunction(cancelActiveFn)) thisArg[cancelActiveFn]()\n\n      thisArg._components.forEach(thisArg._teardown)\n      thisArg._components = []\n    }\n  },\n}\n","/**\n * Log a console message.\n * @param {String} message\n * @param {String} type\n */\nexport const log = (message, type = \"error\") => console[type](message)\n","import { isBrowserEnv } from \"./is-browser-env\"\nimport { Selectors, Messages, KeyCodes, Events } from \"./constants\"\nimport { log } from \"./log\"\nimport { getFocusableElements } from \"./dom\"\n/**\n * Factory function that creates focus trap helpers.\n *\n * ```js\n * const focusTrap = createFocusTrap(\"#element-id\")\n * focusTrap.start()\n * focusTrap.stop()\n * ```\n *\n * Pass an object in the second param to use other helpers for arrow trapping, custom children, and custom matchers.\n *\n * ```js\n * const focusTrap = createFocusTrap(\"#element-id\", {\n *    useArrows: true,\n *    children: [],\n *    matchers: ['a', 'button', '.my-cool-element']\n * })\n * focusTrap.start()\n * ```\n *\n * @param {String} selectorString\n * @param {{ useArrows, children: (NodeList|Element[]), matchers: String[] }} options - useArrows is coerced to true/false.\n * @returns {{ start: Function, stop: Function }}\n */\nexport const createFocusTrap = (selectorString, options = {}) => {\n  if (!isBrowserEnv) return\n  const { useArrows, children, matchers = Selectors.FOCUSABLE_TAGS } = options\n\n  if (!selectorString && !children.length) {\n    log(Messages.NO_SELECTOR_STRING_OR_CHILDREN_ERROR)\n    return\n  }\n\n  if (!Array.isArray(matchers)) {\n    log(Messages.OPTION_MATCHERS_DATA_TYPE_ERROR)\n    return\n  } else if (matchers.length) {\n    let hasBadMatcher = false\n\n    matchers.forEach(matcher => {\n      const type = typeof matcher\n      if (type !== \"string\") {\n        log(Messages.INCORRECT_MATCHER_TYPE_ERROR(type))\n        hasBadMatcher = true\n      }\n    })\n\n    if (hasBadMatcher) return\n  } else if (!matchers.length) {\n    log(Messages.NO_MATCHER_LENGTH_ERROR)\n    return\n  }\n\n  const focusableChildren =\n    children && children.length ? children : getFocusableElements(selectorString, matchers)\n  const focusableFirstChild = focusableChildren[0]\n  const focusableLastChild = focusableChildren[focusableChildren.length - 1]\n\n  const handleFocusTrapWithTab = event => {\n    const containerElement = document.querySelector(selectorString)\n    const containerActive = document.activeElement === containerElement\n    const firstActive = document.activeElement === focusableFirstChild\n    const lastActive = document.activeElement === focusableLastChild\n\n    if (!containerActive && !firstActive && !lastActive) return\n\n    const tabKey = event.which === KeyCodes.TAB\n    const shiftKey = event.which === KeyCodes.SHIFT || event.shiftKey\n    const hasShift = shiftKey && tabKey\n    const noShift = !shiftKey && tabKey\n\n    if (hasShift && (firstActive || containerActive)) {\n      event.preventDefault()\n      focusableLastChild.focus()\n    } else if (noShift && lastActive) {\n      event.preventDefault()\n      focusableFirstChild.focus()\n    }\n  }\n\n  const focusNextChild = () => {\n    for (let i = 0; i < focusableChildren.length; i++) {\n      if (focusableChildren[i] === document.activeElement) {\n        focusableChildren[i + 1].focus()\n        break\n      }\n    }\n  }\n\n  const focusLastChild = () => {\n    for (let i = 0; i < focusableChildren.length; i++) {\n      if (focusableChildren[i] === document.activeElement) {\n        focusableChildren[i - 1].focus()\n        break\n      }\n    }\n  }\n\n  const handleFocusTrapWithArrows = event => {\n    const firstActive = document.activeElement === focusableFirstChild\n    const lastActive = document.activeElement === focusableLastChild\n    const arrowUp = event.which === KeyCodes.ARROW_UP\n    const arrowDown = event.which === KeyCodes.ARROW_DOWN\n\n    if (arrowUp || arrowDown) {\n      event.preventDefault()\n\n      if (firstActive && arrowUp) {\n        focusableLastChild.focus()\n      } else if (lastActive && arrowDown) {\n        focusableFirstChild.focus()\n      } else if (arrowDown) {\n        focusNextChild()\n      } else if (arrowUp) {\n        focusLastChild()\n      }\n    }\n  }\n\n  return {\n    start() {\n      if (useArrows) {\n        document.addEventListener(Events.KEYDOWN, handleFocusTrapWithArrows)\n      } else {\n        document.addEventListener(Events.KEYDOWN, handleFocusTrapWithTab)\n      }\n    },\n    stop() {\n      if (useArrows) {\n        document.removeEventListener(Events.KEYDOWN, handleFocusTrapWithArrows)\n      } else {\n        document.removeEventListener(Events.KEYDOWN, handleFocusTrapWithTab)\n      }\n    },\n  }\n}\n","import { Events, Selectors } from \"./constants\"\n\n/**\n * Focus a single element one time and teardown when unfocused.\n * @param {HTMLElement} element\n */\nexport const focusOnce = element => {\n  const handleBlur = ({ target }) => {\n    target.removeAttribute(Selectors.TABINDEX)\n    target.removeEventListener(Events.BLUR, handleBlur)\n  }\n\n  element.setAttribute(Selectors.TABINDEX, \"-1\")\n  element.focus()\n  element.addEventListener(Events.BLUR, handleBlur)\n}\n","import { isBrowserEnv } from \"./is-browser-env\"\n\n/**\n * Check if the current browser session is within an Apple device.\n *\n * ```js\n * if (isiOSMobile) {\n *   console.log(\"This is on iOS!\")\n * }\n * ```\n *\n * @returns {Boolean}\n */\nexport const isiOSMobile = isBrowserEnv ? /(iphone|ipod|ipad)/i.test(navigator.userAgent) : false\n","export const Selectors = {\n  // unique\n  DATA_COLLAPSIBLE: \"data-collapsible\",\n  // common\n  DATA_VISIBLE: \"data-visible\",\n  DATA_TARGET: \"data-target\",\n  DATA_PARENT: \"data-parent\",\n  // accessibility\n  ARIA_EXPANDED: \"aria-expanded\",\n  ARIA_CONTROLS: \"aria-controls\",\n  ARIA_HIDDEN: \"aria-hidden\",\n  ARIA_LABELLEDBY: \"aria-labelledby\",\n  TABINDEX: \"tabindex\",\n  // classes\n  IS_READY_CLASS: \"is-ready\",\n  IS_VISIBLE_CLASS: \"is-visible\",\n}\n\nexport const CssProperties = {\n  HEIGHT: \"height\",\n  VISIBILITY: \"visibility\",\n}\n\nexport const CssValues = {\n  AUTO: \"auto\",\n  HIDDEN: \"hidden\",\n  VISIBLE: \"visible\",\n}\n\nexport const Events = {\n  CLICK: \"click\",\n  TRANSITIONEND: \"transitionend\",\n}\n\nexport const Messages = {\n  NO_COLLAPSIBLE_ID_ERROR:\n    \"Could not initialize collapsible; you must include a value for the 'data-collapsible' attribute.\",\n  NO_TRIGGER_ERROR: id =>\n    `Could not find collapsible trigger with [data-target='${id}']; you can't have a collapsible without a trigger.`,\n  NO_TRIGGER_ID_ERROR: id => `Could not find id on collapsible trigger with [data-target='${id}'].`,\n  NO_CONTENT_ERROR: id =>\n    `Could not find collapsible content with id '${id}'; you can't have a collapsible without content.`,\n}\n","import { log, ComponentEngine, throttle } from \"../helpers\"\n\nimport { Selectors, CssProperties, CssValues, Events, Messages } from \"./constants\"\n\n// COMPONENT_ROLE is described using `aria-controls` for the collapsible UI pattern.\n\n/**\n * Class that instantiates or destroys all instances of collapsible components on a page.\n *\n * @module Collapsible\n */\nexport default class Collapsible {\n  constructor() {\n    // events\n    this._handleClick = throttle(this._handleClick.bind(this), 500)\n    this._handleExpandTransition = this._handleExpandTransition.bind(this)\n    this._validate = this._validate.bind(this)\n    this._teardown = this._teardown.bind(this)\n\n    // all accordions\n    this._components = []\n\n    // active accordion\n    this._activeCollapsible = {}\n    this._activeTrigger = {}\n    this._activeContent = {}\n    this._activeId = \"\"\n    this._nextAriaExpandedState = \"\"\n    this._nextAriaHiddenState = \"\"\n  }\n\n  // public\n\n  start(id) {\n    ComponentEngine.start({ id, attribute: Selectors.DATA_COLLAPSIBLE, thisArg: this })\n  }\n\n  stop(id) {\n    ComponentEngine.stop({\n      id,\n      attribute: Selectors.DATA_COLLAPSIBLE,\n      thisArg: this,\n      activeNodeKey: \"_activeCollapsible\",\n    })\n  }\n\n  // private\n\n  _validate(instance) {\n    const { trigger, id } = this._getCollapsibleData(instance)\n\n    if (!id) {\n      log(Messages.NO_COLLAPSIBLE_ID_ERROR)\n      return false\n    }\n\n    if (!trigger) {\n      log(Messages.NO_TRIGGER_ERROR(id))\n      return false\n    }\n\n    if (!trigger.id) {\n      log(Messages.NO_TRIGGER_ID_ERROR(id))\n      return false\n    }\n\n    const contentId = `#${id}`\n    const content = instance.querySelector(contentId)\n\n    if (!content) {\n      log(Messages.NO_CONTENT_ERROR(id))\n      return false\n    }\n\n    trigger.setAttribute(Selectors.ARIA_CONTROLS, id)\n    content.setAttribute(Selectors.ARIA_LABELLEDBY, trigger.id)\n\n    const contentIsVisible = instance.getAttribute(Selectors.DATA_VISIBLE) === \"true\"\n\n    if (contentIsVisible) {\n      instance.setAttribute(Selectors.DATA_VISIBLE, \"true\")\n      trigger.setAttribute(Selectors.ARIA_EXPANDED, \"true\")\n      content.setAttribute(Selectors.ARIA_HIDDEN, \"false\")\n      content.style[CssProperties.HEIGHT] = `${content.scrollHeight}px`\n      content.classList.add(Selectors.IS_VISIBLE_CLASS)\n    } else {\n      instance.setAttribute(Selectors.DATA_VISIBLE, \"false\")\n      trigger.setAttribute(Selectors.ARIA_EXPANDED, \"false\")\n      content.setAttribute(Selectors.ARIA_HIDDEN, \"true\")\n    }\n\n    requestAnimationFrame(() => {\n      trigger.classList.add(Selectors.IS_READY_CLASS)\n      content.classList.add(Selectors.IS_READY_CLASS)\n    })\n\n    trigger.addEventListener(Events.CLICK, this._handleClick)\n\n    return true\n  }\n\n  _teardown(instance) {\n    const { trigger } = this._getCollapsibleData(instance)\n    trigger.removeEventListener(Events.CLICK, this._handleClick)\n  }\n\n  _handleClick(event) {\n    event.preventDefault()\n\n    this._activeTrigger = event.target\n\n    this._setIds()\n    this._setActiveCollapsible()\n    this._setActiveContent()\n    this._setNextVisibleState()\n    this._toggleCollapsible()\n\n    this._activeCollapsible = null\n  }\n\n  _handleExpandTransition() {\n    this._activeContent.style[CssProperties.HEIGHT] = CssValues.AUTO\n    this._activeContent.removeEventListener(Events.TRANSITIONEND, this._handleExpandTransition)\n  }\n\n  _toggleCollapsible() {\n    this._activeCollapsible.setAttribute(Selectors.DATA_VISIBLE, this._nextAriaExpandedState)\n    this._activeTrigger.setAttribute(Selectors.ARIA_EXPANDED, this._nextAriaExpandedState)\n    this._activeContent.setAttribute(Selectors.ARIA_HIDDEN, this._nextAriaHiddenState)\n\n    const fullHeightValue = `${this._activeContent.scrollHeight}px`\n\n    if (this._activeCollapsible.getAttribute(Selectors.DATA_VISIBLE) === \"false\") {\n      return this._collapsePanel(fullHeightValue)\n    }\n\n    this._expandPanel(fullHeightValue)\n  }\n\n  _expandPanel(height) {\n    this._activeContent.style[CssProperties.HEIGHT] = height\n    this._activeContent.classList.add(Selectors.IS_VISIBLE_CLASS)\n    this._activeContent.addEventListener(Events.TRANSITIONEND, this._handleExpandTransition)\n  }\n\n  _collapsePanel(height) {\n    return requestAnimationFrame(() => {\n      this._activeContent.style[CssProperties.HEIGHT] = height\n\n      requestAnimationFrame(() => {\n        this._activeContent.style[CssProperties.HEIGHT] = null\n        this._activeContent.classList.remove(Selectors.IS_VISIBLE_CLASS)\n      })\n    })\n  }\n\n  _getCollapsibleData(instance) {\n    const id = instance.getAttribute(Selectors.DATA_COLLAPSIBLE)\n    const trigger = instance.querySelector(`[${Selectors.DATA_TARGET}='${id}']`)\n\n    return { id, trigger }\n  }\n\n  _setActiveContent() {\n    this._activeContent = this._activeCollapsible.querySelector(`#${this._activeId}`)\n  }\n\n  _setNextVisibleState() {\n    const currentVisibleState = this._activeCollapsible.getAttribute(Selectors.DATA_VISIBLE)\n    this._nextAriaExpandedState = currentVisibleState === \"true\" ? \"false\" : \"true\"\n    this._nextAriaHiddenState = currentVisibleState === \"false\" ? \"false\" : \"true\"\n  }\n\n  _setIds() {\n    this._activeId = this._activeTrigger.getAttribute(Selectors.DATA_TARGET)\n  }\n\n  _setActiveCollapsible() {\n    this._activeCollapsible = document.querySelector(\n      `[${Selectors.DATA_COLLAPSIBLE}='${this._activeId}']`\n    )\n  }\n}\n","/**\n * Simple throttle utility; prevent a function from firing for a period of milliseconds.\n * @param {*} callback - function to throttle\n * @param {number} limit - time to throttle by in milliseconds\n */\nexport function throttle(callback, limit) {\n  let timeout = false\n\n  function clear() {\n    timeout = false\n  }\n\n  return function() {\n    if (timeout) return\n\n    callback.apply(this, arguments)\n    timeout = true\n    setTimeout(clear, limit)\n  }\n}\n","export const KeyCodes = {\n  TAB: 9,\n  SHIFT: 16,\n  ESCAPE: 27,\n  ARROW_UP: 38,\n  ARROW_DOWN: 40,\n}\n\nexport const Selectors = {\n  // unique\n  DATA_DROPDOWN: \"data-dropdown\",\n  DROPDOWN_MENU_CLASS: \"dropdown-menu\",\n  // common\n  DATA_TARGET: \"data-target\",\n  DATA_PARENT: \"data-parent\",\n  DATA_VISIBLE: \"data-visible\",\n  // accessibility\n  TABINDEX: \"tabindex\",\n  ARIA_HASPOPUP: \"aria-haspopup\",\n  ARIA_CONTROLS: \"aria-controls\",\n  ARIA_LABELLEDBY: \"aria-labelledby\",\n  ARIA_EXPANDED: \"aria-expanded\",\n  // classes\n  OVERLAY_OPEN: \"overlay-open\",\n}\n\nexport const Events = {\n  KEYDOWN: \"keydown\",\n  CLICK: \"click\",\n  BLUR: \"blur\",\n}\n\nexport const Messages = {\n  NO_DROPDOWN_ID_ERROR:\n    \"Could not setup dropdown. Make sure it has a valid [data-dropdown] attribute with a unique id as its value.\",\n  NO_MENU_ERROR: attr => `Could not find menu associated with ${attr}.`,\n  NO_DROPDOWN_ITEMS_ERROR: attr => `Could not find any list items associated with ${attr}.`,\n  NO_DROPDOWN_ACTIONS_ERROR: attr =>\n    `Could not find any button or anchor elements associated with ${attr}.`,\n  NO_PARENT_ERROR: \"Could not find dropdown button's [data-parent] attribute.\",\n}\n","import { isiOSMobile, createFocusTrap, focusOnce, queryAll, log, ComponentEngine } from \"../helpers\"\nimport { KeyCodes, Selectors, Events, Messages } from \"./constants\"\n\n/**\n * Class that instantiates or destroys all instances of dropdown components on a page.\n *\n * @module Dropdown\n */\nexport default class Dropdown {\n  constructor() {\n    // events\n    this._handleClick = this._handleClick.bind(this)\n    this._handleFirstTabClose = this._handleFirstTabClose.bind(this)\n    this._handleLastTabClose = this._handleLastTabClose.bind(this)\n    this._handleArrowKeyPress = this._handleArrowKeyPress.bind(this)\n    this._handleClose = this._handleClose.bind(this)\n    this._handleEscapeKeyPress = this._handleEscapeKeyPress.bind(this)\n    this._handleOffMenuClick = this._handleOffMenuClick.bind(this)\n    this._validate = this._validate.bind(this)\n    this._teardown = this._teardown.bind(this)\n\n    // all dropdowns\n    this._components = []\n\n    // active dropdown\n    this._activeDropdownId = \"\"\n    this._activeDropdownAttr = \"\"\n    this._activeDropdownMenuId = \"\"\n    this._activeDropdown = null\n    this._activeTrigger = null\n    this._activeDropdownMenu = null\n    this._firstDropdownAction = null\n    this._lastDropdownAction = null\n    this._focusTrap = null\n    this._activeDropdownActions = []\n    this._allowFocusReturn = true\n\n    // dropdown element selectors\n    this._dropdownContainerAttr = `[${Selectors.DATA_DROPDOWN}]`\n    this._dropdownTargetAttr = `[${Selectors.DATA_TARGET}]`\n    this._dropdownMenuClassName = `.${Selectors.DROPDOWN_MENU_CLASS}`\n  }\n\n  // public\n\n  start(id) {\n    ComponentEngine.start({ id, attribute: Selectors.DATA_DROPDOWN, thisArg: this })\n  }\n\n  stop(id) {\n    ComponentEngine.stop({\n      id,\n      attribute: Selectors.DATA_DROPDOWN,\n      thisArg: this,\n      activeNodeKey: \"_activeDropdown\",\n      cancelActiveFn: \"_closeActiveDropdown\",\n    })\n  }\n\n  // private\n\n  _validate(instance) {\n    const dropdownId = instance.getAttribute(Selectors.DATA_DROPDOWN)\n\n    if (!dropdownId) {\n      log(Messages.NO_DROPDOWN_ID_ERROR)\n      return false\n    }\n\n    const dropdownAttr = `[${Selectors.DATA_DROPDOWN}=\"${dropdownId}\"]`\n    const dropdown = document.querySelector(`[${Selectors.DATA_DROPDOWN}=\"${dropdownId}\"]`)\n\n    // no trigger error!\n\n    const dropdownTrigger = dropdown.querySelector(`[${Selectors.DATA_TARGET}]`)\n\n    if (!dropdownTrigger.getAttribute(Selectors.DATA_PARENT)) {\n      log(Messages.NO_PARENT_ERROR)\n      return false\n    }\n\n    const dropdownMenuId = dropdownTrigger.getAttribute(Selectors.DATA_TARGET)\n\n    // no target error!\n\n    const dropdownMenu = dropdown.querySelector(`#${dropdownMenuId}`)\n\n    if (!dropdownMenu) {\n      log(Messages.NO_MENU_ERROR(dropdownAttr))\n      return false\n    }\n\n    dropdownMenu.setAttribute(Selectors.ARIA_LABELLEDBY, dropdownTrigger.id)\n\n    dropdownTrigger.setAttribute(Selectors.ARIA_CONTROLS, dropdownMenuId)\n    dropdownTrigger.setAttribute(Selectors.ARIA_HASPOPUP, \"true\")\n    dropdownTrigger.setAttribute(Selectors.ARIA_EXPANDED, \"false\")\n\n    const dropdownMenuListItems = dropdown.querySelectorAll(`#${dropdownMenuId} > li`)\n\n    if (!dropdownMenuListItems.length) {\n      log(Messages.NO_DROPDOWN_ITEMS_ERROR(dropdownAttr))\n      return false\n    }\n\n    const dropdownMenuActions = this._getDropdownActions(dropdownAttr, `#${dropdownMenuId}`)\n\n    if (!dropdownMenuActions.length) {\n      log(Messages.NO_DROPDOWN_ACTIONS_ERROR(dropdownAttr))\n      return false\n    }\n\n    dropdownMenuActions.forEach(trigger => {\n      trigger.setAttribute(Selectors.TABINDEX, \"-1\")\n    })\n\n    dropdownTrigger.addEventListener(Events.CLICK, this._handleClick)\n    dropdownTrigger.addEventListener(Events.KEYDOWN, this._handleArrowKeyPress)\n\n    return true\n  }\n\n  _teardown(instance) {\n    const id = instance.getAttribute(Selectors.DATA_DROPDOWN)\n    const trigger = instance.querySelector(`[${Selectors.DATA_PARENT}='${id}']`)\n\n    trigger.removeEventListener(Events.CLICK, this._handleClick)\n    trigger.removeEventListener(Events.KEYDOWN, this._handleArrowKeyPress)\n  }\n\n  _handleClick(event, key) {\n    event.preventDefault()\n    event.stopPropagation()\n    this._closeOpenDropdowns(event)\n\n    this._activeTrigger = event.target\n\n    this._setActiveDropdownId()\n    this._setActiveDropdown()\n    this._setActiveDropdownMenu()\n    this._setVisibleState()\n    this._startActiveDropdownEvents()\n\n    if (key && key === KeyCodes.ARROW_UP) {\n      this._lastDropdownAction.focus()\n    } else {\n      this._firstDropdownAction.focus()\n    }\n\n    if (isiOSMobile) document.body.classList.add(Selectors.OVERLAY_OPEN)\n  }\n\n  _handleClose() {\n    if (this._allowFocusReturn) this._handleReturnFocus()\n    this._closeActiveDropdown()\n  }\n\n  _closeActiveDropdown() {\n    if (isiOSMobile) document.body.classList.remove(Selectors.OVERLAY_OPEN)\n\n    this._activeDropdown.setAttribute(Selectors.DATA_VISIBLE, \"false\")\n    this._activeTrigger.setAttribute(Selectors.ARIA_EXPANDED, \"false\")\n\n    this._activeTrigger.removeEventListener(Events.CLICK, this._handleClose)\n    this._activeTrigger.addEventListener(Events.CLICK, this._handleClick)\n    document.removeEventListener(Events.KEYDOWN, this._handleEscapeKeyPress)\n    document.removeEventListener(Events.CLICK, this._handleOffMenuClick)\n    this._firstDropdownAction.removeEventListener(Events.KEYDOWN, this._handleFirstTabClose)\n    this._lastDropdownAction.removeEventListener(Events.KEYDOWN, this._handleLastTabClose)\n\n    this._activeDropdownActions.forEach(action => {\n      action.setAttribute(Selectors.TABINDEX, \"-1\")\n      action.removeEventListener(Events.CLICK, this._handleClose)\n    })\n\n    this._focusTrap.stop()\n    this._focusTrap = null\n\n    this._resetProperties()\n  }\n\n  _resetProperties() {\n    this._activeDropdownId = \"\"\n    this._activeDropdownAttr = \"\"\n    this._activeDropdownMenuId = \"\"\n    this._activeDropdown = null\n    this._activeTrigger = null\n    this._activeDropdownMenu = null\n    this._firstDropdownAction = null\n    this._lastDropdownAction = null\n    this._focusTrap = null\n    this._activeDropdownActions = []\n    this._allowFocusReturn = true\n  }\n\n  _setActiveDropdownId() {\n    this._activeDropdownId = this._activeTrigger.getAttribute(Selectors.DATA_PARENT)\n  }\n\n  _startActiveDropdownEvents() {\n    this._activeTrigger.removeEventListener(Events.CLICK, this._handleClick)\n    this._activeTrigger.addEventListener(Events.CLICK, this._handleClose)\n    document.addEventListener(Events.KEYDOWN, this._handleEscapeKeyPress)\n    document.addEventListener(Events.CLICK, this._handleOffMenuClick)\n\n    this._activeDropdownActions = this._getDropdownActions(\n      this._activeDropdownAttr,\n      `#${this._activeDropdownMenuId}`\n    )\n\n    this._firstDropdownAction = this._activeDropdownActions[0]\n    this._lastDropdownAction = this._activeDropdownActions[this._activeDropdownActions.length - 1]\n\n    this._firstDropdownAction.addEventListener(Events.KEYDOWN, this._handleFirstTabClose)\n    this._lastDropdownAction.addEventListener(Events.KEYDOWN, this._handleLastTabClose)\n\n    this._activeDropdownActions.forEach(action => {\n      action.setAttribute(Selectors.TABINDEX, \"0\")\n      action.addEventListener(Events.CLICK, this._handleClose)\n    })\n\n    const containerSelector = `${this._activeDropdownAttr} > ${this._dropdownMenuClassName}`\n\n    if (this._focusTrap) {\n      this._focusTrap.stop()\n    }\n\n    this._focusTrap = createFocusTrap(containerSelector, { useArrows: true })\n    this._focusTrap.start()\n  }\n\n  _setVisibleState() {\n    this._activeTrigger.setAttribute(Selectors.ARIA_EXPANDED, \"true\")\n    this._activeDropdown.setAttribute(Selectors.DATA_VISIBLE, \"true\")\n  }\n\n  _setActiveDropdownMenu() {\n    this._activeDropdownMenuId = this._activeTrigger.getAttribute(Selectors.DATA_TARGET)\n    this._activeDropdownMenu = this._activeDropdown.querySelector(`#${this._activeDropdownMenuId}`)\n  }\n\n  _setActiveDropdown() {\n    this._activeDropdownAttr = `[${Selectors.DATA_DROPDOWN}=\"${this._activeDropdownId}\"]`\n    this._activeDropdown = document.querySelector(this._activeDropdownAttr)\n  }\n\n  _closeOpenDropdowns(event) {\n    if (!this._activeTrigger) return\n\n    this._allowFocusReturn = false\n    this._handleClose(event)\n    this._allowFocusReturn = true\n  }\n\n  _handleFirstTabClose(event) {\n    const shiftKey = event.which === KeyCodes.SHIFT || event.shiftKey\n    const tabKey = event.which === KeyCodes.TAB\n\n    if (shiftKey && tabKey) {\n      this._handleClose(event)\n    }\n  }\n\n  _handleLastTabClose(event) {\n    const shiftKey = event.which === KeyCodes.SHIFT || event.shiftKey\n    const tabKey = event.which === KeyCodes.TAB\n\n    if (tabKey && !shiftKey) {\n      this._handleClose(event)\n    }\n  }\n\n  _handleArrowKeyPress(event) {\n    if (event.which === KeyCodes.ARROW_UP || event.which === KeyCodes.ARROW_DOWN) {\n      this._handleClick(event, event.which)\n    }\n  }\n\n  _handleEscapeKeyPress(event) {\n    if (event.which === KeyCodes.ESCAPE) {\n      this._handleClose(event)\n    }\n  }\n\n  _handleOffMenuClick(event) {\n    if (event.target !== this._activeTrigger && event.target !== this._activeDropdownMenu) {\n      this._handleClose(event)\n    }\n  }\n\n  _handleReturnFocus() {\n    if (!this._activeTrigger) return\n    focusOnce(this._activeTrigger)\n  }\n\n  _getDropdownActions(dropdownAttr, menuId) {\n    return queryAll(\n      `${dropdownAttr} > ${menuId} > li > a, ${dropdownAttr} > ${menuId} > li > button`\n    )\n  }\n}\n","export const KeyCodes = {\n  ESCAPE: 27,\n}\n\nexport const Selectors = {\n  // unique\n  DATA_MODAL: \"data-modal\",\n  // common\n  DATA_TARGET: \"data-target\",\n  DATA_VISIBLE: \"data-visible\",\n  DATA_CLOSE: \"data-close\",\n  DATA_PARENT: \"data-parent\",\n  // accessibility\n  ARIA_HIDDEN: \"aria-hidden\",\n  ARIA_MODAL: \"aria-modal\",\n  ROLE: \"role\",\n  TABINDEX: \"tabindex\",\n  // classes\n  NO_SCROLL_CLASS: \"no-scroll\",\n  IS_VISIBLE_CLASS: \"is-visible\",\n  OVERLAY_OPEN: \"overlay-open\",\n}\n\nexport const CssProperties = {\n  PADDING_RIGHT: \"paddingRight\",\n  PADDING_LEFT: \"paddingLeft\",\n}\n\nexport const Events = {\n  KEYDOWN: \"keydown\",\n  CLICK: \"click\",\n  RESIZE: \"resize\",\n  BLUR: \"blur\",\n  TRANSITIONEND: \"transitionend\",\n}\n\nexport const Messages = {\n  NO_TRIGGER_ERROR: id => `Could not find modal trigger with id ${id}.`,\n  NO_ID_ERROR:\n    \"Could not detect an id on your [data-modal] element. \" +\n    \"Please add a value matching the modal trigger's [data-parent] attribute.\",\n  NO_MODAL_DIALOG_ERROR: id => `Could not find element with attribute [data-parent='${id}'].`,\n}\n","import {\n  isiOSMobile,\n  getFocusableElements,\n  createFocusTrap,\n  focusOnce,\n  log,\n  queryAll,\n  ComponentEngine,\n} from \"../helpers\"\nimport { KeyCodes, Selectors, CssProperties, Events, Messages } from \"./constants\"\n\nconst COMPONENT_ROLE = \"dialog\"\n\n/**\n * Class that instantiates or destroys all instances of modal components on a page.\n *\n * @module Modal\n */\nexport default class Modal {\n  constructor() {\n    this._handleClick = this._handleClick.bind(this)\n    this._handleOpenTransition = this._handleOpenTransition.bind(this)\n    this._handleCloseTransition = this._handleCloseTransition.bind(this)\n    this._handleClose = this._handleClose.bind(this)\n    this._handleOverlayClick = this._handleOverlayClick.bind(this)\n    this._handleEscapeKeyPress = this._handleEscapeKeyPress.bind(this)\n    this._validate = this._validate.bind(this)\n    this._teardown = this._teardown.bind(this)\n\n    // all modals\n    this._components = []\n\n    // active modal\n    this._activeModalTrigger = null\n    this._activeModalAttr = \"\"\n    this._activeModal = null\n    this._activeModalContent = null\n    this._activeModalId = \"\"\n    this._activeModalContentSelector = \"\"\n    this._activeModalCloseTriggers = []\n    this._originalPagePadding = \"\"\n    this._scrollbarOffset = null\n    this._focusTrap = null\n  }\n\n  // public\n\n  start(id) {\n    ComponentEngine.start({ id, attribute: Selectors.DATA_MODAL, thisArg: this })\n  }\n\n  stop(id) {\n    ComponentEngine.stop({\n      id,\n      attribute: Selectors.DATA_MODAL,\n      thisArg: this,\n      activeNodeKey: \"_activeModal\",\n      cancelActiveFn: \"_closeActiveModal\",\n    })\n  }\n\n  // private\n\n  _validate(instance) {\n    const id = instance.getAttribute(Selectors.DATA_MODAL)\n\n    if (!id) {\n      log(Messages.NO_ID_ERROR)\n      return false\n    }\n\n    const modal = document.querySelector(`[${Selectors.DATA_MODAL}='${id}']`)\n    const modalContent = instance.querySelector(`[${Selectors.DATA_PARENT}='${id}']`)\n\n    if (!modalContent) {\n      log(Messages.NO_MODAL_DIALOG_ERROR(id))\n      return false\n    }\n\n    modal.setAttribute(Selectors.ARIA_HIDDEN, \"true\")\n    modal.setAttribute(Selectors.DATA_VISIBLE, \"false\")\n    modalContent.setAttribute(Selectors.ARIA_MODAL, \"true\")\n    modalContent.setAttribute(Selectors.ROLE, COMPONENT_ROLE)\n\n    const trigger = document.querySelector(`[${Selectors.DATA_TARGET}='${id}']`)\n\n    if (!trigger) {\n      log(Messages.NO_TRIGGER_ERROR(id))\n      return false\n    }\n\n    trigger.addEventListener(Events.CLICK, this._handleClick)\n    return true\n  }\n\n  _teardown(instance) {\n    const id = instance.getAttribute(Selectors.DATA_MODAL)\n    const trigger = document.querySelector(`[${Selectors.DATA_TARGET}='${id}']`)\n\n    trigger.removeEventListener(Events.CLICK, this._handleClick)\n  }\n\n  _handleClick(event) {\n    event.preventDefault()\n\n    this._activeModalTrigger = event.target\n\n    this._setActiveId()\n    this._setActiveModal()\n    this._setActiveModalContent()\n    this._setScrollbarOffset()\n    this._setScrollStop()\n\n    this._focusTrap = createFocusTrap(this._activeModalContentSelector)\n    this._focusTrap.start()\n\n    this._toggleVisibility(true)\n    this._setFocusableChildren()\n    this._setCloseTriggers()\n\n    this._startEvents()\n  }\n\n  _handleClose(event) {\n    event.preventDefault()\n    this._closeActiveModal()\n  }\n\n  _closeActiveModal() {\n    this._toggleVisibility(false)\n    this._focusTrigger()\n    this._unsetScrollStop()\n    this._unsetScrollbarOffset()\n\n    document.removeEventListener(Events.KEYDOWN, this._handleEscapeKeyPress)\n    document.removeEventListener(Events.CLICK, this._handleOverlayClick)\n\n    this._activeModalCloseTriggers.forEach(trigger => {\n      trigger.removeEventListener(Events.CLICK, this._handleClose)\n    })\n\n    this._focusTrap.stop()\n    this._resetProperties()\n  }\n\n  _resetProperties() {\n    this._activeModal = null\n    this._activeModalTrigger = null\n    this._activeModalContent = null\n    this._activeModalId = \"\"\n    this._activeModalContentSelector = \"\"\n    this._activeModalCloseTriggers = []\n    this._originalPagePadding = \"\"\n    this._scrollbarOffset = null\n    this._focusTrap = null\n  }\n\n  _setFocusableChildren() {\n    const elements = getFocusableElements(this._activeModalContentSelector)\n    if (!elements.length) return\n\n    elements.forEach(element => element.setAttribute(Selectors.TABINDEX, \"0\"))\n  }\n\n  _setCloseTriggers() {\n    this._activeModalCloseTriggers = queryAll(\n      `${this._activeModalContentSelector} [${Selectors.DATA_CLOSE}]`\n    )\n  }\n\n  _setActiveId() {\n    this._activeModalId = this._activeModalTrigger.getAttribute(Selectors.DATA_TARGET)\n  }\n\n  _setActiveModal() {\n    this._activeModalAttr = `[${Selectors.DATA_MODAL}='${this._activeModalId}']`\n    this._activeModal = document.querySelector(`[${Selectors.DATA_MODAL}='${this._activeModalId}']`)\n  }\n\n  _setActiveModalContent() {\n    this._activeModalContentSelector = `[${Selectors.DATA_PARENT}='${this._activeModalId}']`\n    this._activeModalContent = this._activeModal.querySelector(this._activeModalContentSelector)\n  }\n\n  _handleOpenTransition() {\n    this._activeModal.removeEventListener(Events.TRANSITIONEND, this._handleOpenTransition)\n    this._focusContent()\n\n    // Setting `scrollTop` to `0` unshifts the\n    // scroll caused by focusing the dialog element\n    this._activeModal.scrollTop = 0\n  }\n\n  _handleCloseTransition() {\n    this._modalCache.style[CssProperties.PADDING_LEFT] = \"\"\n    this._modalCache.removeEventListener(Events.TRANSITIONEND, this._handleCloseTransition)\n    this._modalCache = null\n  }\n\n  _toggleVisibility(isVisible) {\n    this._activeModal.setAttribute(Selectors.ARIA_HIDDEN, isVisible ? \"false\" : \"true\")\n    this._activeModal.setAttribute(Selectors.DATA_VISIBLE, isVisible ? \"true\" : \"false\")\n\n    if (isVisible) {\n      this._activeModal.classList.add(Selectors.IS_VISIBLE_CLASS)\n      this._activeModal.addEventListener(Events.TRANSITIONEND, this._handleOpenTransition)\n    } else {\n      this._modalCache = this._activeModal\n      this._activeModal.classList.remove(Selectors.IS_VISIBLE_CLASS)\n      this._activeModal.addEventListener(Events.TRANSITIONEND, this._handleCloseTransition)\n    }\n  }\n\n  _startEvents() {\n    document.addEventListener(Events.KEYDOWN, this._handleEscapeKeyPress)\n    document.addEventListener(Events.CLICK, this._handleOverlayClick)\n\n    this._activeModalCloseTriggers.forEach(trigger => {\n      trigger.addEventListener(Events.CLICK, this._handleClose)\n    })\n  }\n\n  _getScrollbarOffset() {\n    return window.innerWidth - document.body.getBoundingClientRect().right\n  }\n\n  _setScrollbarOffset() {\n    if (!this._scrollbarIsVisible()) return\n\n    this._scrollbarOffset = this._getScrollbarOffset()\n    this._originalPagePadding = document.body.style[CssProperties.PADDING_RIGHT]\n    document.body.style[CssProperties.PADDING_RIGHT] = `${this._scrollbarOffset}px`\n  }\n\n  _scrollbarIsVisible() {\n    if (typeof window.innerWidth === \"number\") {\n      return window.innerWidth > document.body.getBoundingClientRect().right\n    }\n  }\n\n  _unsetScrollbarOffset() {\n    if (!this._activeModal) return\n    const originalPaddingRight = this._originalPagePadding\n\n    this._activeModal.style[CssProperties.PADDING_LEFT] = `${this._scrollbarOffset}px`\n    document.body.style[CssProperties.PADDING_RIGHT] = originalPaddingRight\n  }\n\n  _handleOverlayClick(event) {\n    if (event.target === this._activeModal) {\n      this._handleClose(event)\n    }\n  }\n\n  _handleEscapeKeyPress(event) {\n    if (event.which === KeyCodes.ESCAPE) {\n      this._handleClose(event)\n    }\n  }\n\n  _focusContent() {\n    focusOnce(this._activeModalContent)\n  }\n\n  _focusTrigger() {\n    focusOnce(this._activeModalTrigger)\n  }\n\n  _unsetScrollStop() {\n    if (isiOSMobile) document.body.classList.remove(Selectors.OVERLAY_OPEN)\n    document.body.classList.remove(Selectors.NO_SCROLL_CLASS)\n    document.documentElement.classList.remove(Selectors.NO_SCROLL_CLASS)\n  }\n\n  _setScrollStop() {\n    if (isiOSMobile) document.body.classList.add(Selectors.OVERLAY_OPEN)\n    document.body.classList.add(Selectors.NO_SCROLL_CLASS)\n    document.documentElement.classList.add(Selectors.NO_SCROLL_CLASS)\n  }\n}\n","export const KeyCodes = {\n  ESCAPE: 27,\n}\n\nexport const Selectors = {\n  // unique\n  DATA_TOOLTIP: \"data-tooltip\",\n  // common\n  DATA_VISIBLE: \"data-visible\",\n  DATA_TARGET: \"data-target\",\n  // accessibility\n  ROLE: \"role\",\n  ARIA_DESCRIBEDBY: \"aria-describedby\",\n  // classes\n  DROP_INLINE_START_CLASS: \"is-drop-inline-start\",\n  DROP_INLINE_END_CLASS: \"is-drop-inline-end\",\n  OVERLAY_OPEN: \"overlay-open\",\n}\n\nexport const CssProperties = {\n  HEIGHT: \"height\",\n  WIDTH: \"width\",\n  TOP: \"top\",\n  LEFT: \"left\",\n}\n\nexport const Events = {\n  CLICK: \"click\",\n  MOUSEOVER: \"mouseover\",\n  MOUSEOUT: \"mouseout\",\n  FOCUS: \"focus\",\n  BLUR: \"blur\",\n  KEYDOWN: \"keydown\",\n}\n\nexport const Messages = {\n  NO_ID_ERROR: \"Could not find tooltip id.\",\n  NO_TRIGGER_ERROR: id => `Could not find a tooltip trigger with attribute [data-target='${id}'].`,\n  NO_TOOLTIP_ERROR: id => `Could not find a tooltip with id '${id}'.`,\n}\n","import { isiOSMobile, log, ComponentEngine } from \"../helpers\"\nimport { KeyCodes, Selectors, CssProperties, Events, Messages } from \"./constants\"\n\nconst COMPONENT_ROLE = \"tooltip\"\n\n/**\n * Class that instantiates or destroys all instances of tooltip components on a page.\n *\n * @module Tooltip\n */\nexport default class Tooltip {\n  constructor() {\n    this._handleEvent = this._handleEvent.bind(this)\n    this._handleClose = this._handleClose.bind(this)\n    this._handleEscapeKeyPress = this._handleEscapeKeyPress.bind(this)\n    this._validate = this._validate.bind(this)\n    this._teardown = this._teardown.bind(this)\n\n    // all tooltips\n    this._components = []\n\n    // active tooltip\n    this._activeTrigger = null\n    this._activeTooltipBox = null\n  }\n\n  // public\n\n  start(id) {\n    ComponentEngine.start({ id, attribute: Selectors.DATA_TOOLTIP, thisArg: this })\n  }\n\n  stop(id) {\n    ComponentEngine.stop({\n      id,\n      attribute: Selectors.DATA_TOOLTIP,\n      thisArg: this,\n      activeNodeKey: \"_activeTooltip\",\n      cancelActiveFn: \"_handleClose\",\n    })\n  }\n\n  // private\n\n  _validate(instance) {\n    const instanceId = instance.getAttribute(Selectors.DATA_TOOLTIP)\n\n    if (!instanceId) {\n      log(Messages.NO_ID_ERROR)\n      return false\n    }\n\n    const trigger = instance.querySelector(this._getTrigger(instanceId))\n    const tooltip = instance.querySelector(`#${instanceId}`)\n\n    if (!trigger) {\n      log(Messages.NO_TRIGGER_ERROR(instanceId))\n      return false\n    }\n\n    if (!tooltip) {\n      log(Messages.NO_TOOLTIP_ERROR(instanceId))\n      return false\n    }\n\n    trigger.setAttribute(Selectors.ARIA_DESCRIBEDBY, instanceId)\n    tooltip.setAttribute(Selectors.ROLE, COMPONENT_ROLE)\n\n    trigger.addEventListener(Events.MOUSEOVER, this._handleEvent)\n    trigger.addEventListener(Events.FOCUS, this._handleEvent)\n\n    return true\n  }\n\n  _teardown(instance) {\n    const id = instance.getAttribute(Selectors.DATA_TOOLTIP)\n    const trigger = instance.querySelector(this._getTrigger(id))\n\n    trigger.removeEventListener(Events.MOUSEOVER, this._handleEvent)\n    trigger.removeEventListener(Events.FOCUS, this._handleEvent)\n  }\n\n  _handleEvent(event) {\n    if (this._activeTooltip) this._handleClose()\n\n    this._activeTrigger = event.target\n\n    const id = this._activeTrigger.getAttribute(Selectors.DATA_TARGET)\n    this._activeTooltip = document.querySelector(`[${Selectors.DATA_TOOLTIP}='${id}']`)\n    this._activeTooltipBox = document.querySelector(`#${id}`)\n\n    if (this._hasInlineClass()) {\n      this._alignTooltip(CssProperties.HEIGHT)\n    } else {\n      this._alignTooltip(CssProperties.WIDTH)\n    }\n\n    this._setVisibleState()\n    this._startCloseEvents()\n  }\n\n  _handleClose() {\n    if (this._activeTooltipBox) this._setHideState()\n\n    this._startOpenEvents()\n    this._resetProperties()\n  }\n\n  _resetProperties() {\n    this._activeTooltip = null\n    this._activeTrigger = null\n    this._activeTooltipBox = null\n  }\n\n  _setVisibleState() {\n    this._activeTooltipBox.setAttribute(Selectors.DATA_VISIBLE, \"true\")\n  }\n\n  _setHideState() {\n    this._activeTooltipBox.setAttribute(Selectors.DATA_VISIBLE, \"false\")\n  }\n\n  _startCloseEvents() {\n    this._activeTrigger.removeEventListener(Events.MOUSEOVER, this._handleEvent)\n    this._activeTrigger.removeEventListener(Events.FOCUS, this._handleEvent)\n    this._activeTrigger.addEventListener(Events.MOUSEOUT, this._handleClose)\n    this._activeTrigger.addEventListener(Events.BLUR, this._handleClose)\n    document.addEventListener(Events.KEYDOWN, this._handleEscapeKeyPress)\n\n    if (isiOSMobile) document.body.classList.add(Selectors.OVERLAY_OPEN)\n  }\n\n  _handleEscapeKeyPress(event) {\n    if (event.which === KeyCodes.ESCAPE) {\n      this._handleClose()\n    }\n  }\n\n  _startOpenEvents() {\n    if (!this._activeTrigger) return\n\n    this._activeTrigger.removeEventListener(Events.MOUSEOUT, this._handleClose)\n    this._activeTrigger.removeEventListener(Events.BLUR, this._handleClose)\n    this._activeTrigger.addEventListener(Events.MOUSEOVER, this._handleEvent)\n    this._activeTrigger.addEventListener(Events.FOCUS, this._handleEvent)\n    document.removeEventListener(Events.KEYDOWN, this._handleEscapeKeyPress)\n\n    if (isiOSMobile) document.body.classList.remove(Selectors.OVERLAY_OPEN)\n  }\n\n  _alignTooltip(property) {\n    const triggerSize = this._getSize(this._activeTrigger, property)\n    const tooltipSize = this._getSize(this._activeTooltipBox, property)\n    const triggerIsBigger = triggerSize > tooltipSize\n\n    const offset = triggerIsBigger\n      ? (triggerSize - tooltipSize) / 2\n      : (tooltipSize - triggerSize) / -2\n\n    if (property === CssProperties.HEIGHT) {\n      this._activeTooltipBox.style[CssProperties.TOP] = `${offset}px`\n    } else {\n      this._activeTooltipBox.style[CssProperties.LEFT] = `${offset}px`\n    }\n  }\n\n  _getTrigger(id) {\n    return `[${Selectors.DATA_TARGET}=\"${id}\"]`\n  }\n\n  _getSize(element, property) {\n    return Math.floor(element.getBoundingClientRect()[property])\n  }\n\n  _hasInlineClass() {\n    const classList = this._activeTooltipBox.classList\n\n    return (\n      classList.contains(Selectors.DROP_INLINE_START_CLASS) ||\n      classList.contains(Selectors.DROP_INLINE_END_CLASS)\n    )\n  }\n}\n","import _Collapsible from \"./collapsible\"\nimport _Dropdown from \"./dropdown\"\nimport _Modals from \"./modal\"\nimport _Tooltips from \"./tooltip\"\nimport { createFocusRing as _createFocusRing, createFocusTrap as _createFocusTrap } from \"./helpers\"\n\nexport const Collapsibles = new _Collapsible()\nexport const Dropdowns = new _Dropdown()\nexport const Modals = new _Modals()\nexport const Tooltips = new _Tooltips()\nexport const createFocusRing = _createFocusRing\nexport const createFocusTrap = _createFocusTrap\n\nconst Undernet = {\n  Modals,\n  Collapsibles,\n  Dropdowns,\n  Tooltips,\n  createFocusTrap: _createFocusTrap,\n  createFocusRing: _createFocusRing,\n}\n\nconst focusRing = Undernet.createFocusRing()\n\nUndernet.start = (id, enableFocusRing = false) => {\n  Undernet.Modals.start(id)\n  Undernet.Collapsibles.start(id)\n  Undernet.Dropdowns.start(id)\n  Undernet.Tooltips.start(id)\n\n  if (enableFocusRing) focusRing.start()\n}\n\nUndernet.stop = (id, disableFocusRing = false) => {\n  Undernet.Modals.stop(id)\n  Undernet.Collapsibles.stop(id)\n  Undernet.Dropdowns.stop(id)\n  Undernet.Tooltips.stop(id)\n\n  if (disableFocusRing) focusRing.stop()\n}\n\nexport default Undernet\n","import { Events, Selectors } from \"./constants\"\nimport { isBrowserEnv } from \"./is-browser-env\"\n\n/**\n * Factory function that creates focus ring helpers.\n *\n * ```js\n * const focusRing = createFocusRing()\n * focusRing.start()\n * focusRing.stop()\n * ```\n *\n * @returns {{ start: Function, stop: Function }}\n */\nexport const createFocusRing = () => {\n  if (!isBrowserEnv) return\n\n  let listeningForKeydown\n\n  const listenForKeyboard = () => {\n    document.body.classList.add(Selectors.KEYBOARD_CLASS)\n    document.removeEventListener(Events.KEYDOWN, listenForKeyboard)\n    // eslint-disable-next-line no-use-before-define\n    document.addEventListener(Events.CLICK, listenForClick)\n    listeningForKeydown = false\n  }\n\n  const listenForClick = () => {\n    document.body.classList.remove(Selectors.KEYBOARD_CLASS)\n    document.removeEventListener(Events.CLICK, listenForClick)\n    document.addEventListener(Events.KEYDOWN, listenForKeyboard)\n    listeningForKeydown = true\n  }\n\n  return {\n    start() {\n      document.addEventListener(Events.KEYDOWN, listenForKeyboard)\n    },\n    stop() {\n      if (listeningForKeydown) {\n        document.removeEventListener(Events.KEYDOWN, listenForKeyboard)\n      } else {\n        document.body.classList.remove(Selectors.KEYBOARD_CLASS)\n        document.removeEventListener(Events.CLICK, listenForClick)\n      }\n    },\n  }\n}\n","import Undernet from \"./index\"\nimport { isBrowserEnv } from \"./helpers\"\n\nif (isBrowserEnv) {\n  window.Undernet = Undernet\n}\n"],"names":["KeyCodes","Selectors","FOCUSABLE_TAGS","KEYBOARD_CLASS","NOT_VISUALLY_HIDDEN_CLASS","TABINDEX","Events","Messages","type","queryAll","selector","parent","document","Array","apply","querySelectorAll","getFocusableElements","selectorString","matchers","focusables","map","join","isBrowserEnv","window","isString","value","isFunction","ComponentEngine","metadata","id","attribute","thisArg","instance","querySelector","validComponent","filter","_validate","_components","push","length","instances","validComponents","concat","activeNodeKey","cancelActiveFn","targetIndex","activeInstance","index","getAttribute","_teardown","splice","forEach","log","message","console","createFocusTrap","options","useArrows","children","isArray","hasBadMatcher","matcher","focusableChildren","focusableFirstChild","focusableLastChild","handleFocusTrapWithTab","event","containerElement","containerActive","activeElement","firstActive","lastActive","tabKey","which","shiftKey","noShift","preventDefault","focus","focusNextChild","i","focusLastChild","handleFocusTrapWithArrows","arrowUp","arrowDown","start","addEventListener","stop","removeEventListener","focusOnce","element","setAttribute","handleBlur","target","removeAttribute","isiOSMobile","test","navigator","userAgent","CssProperties","CssValues","Collapsible","_handleClick","callback","limit","timeout","clear","this","arguments","setTimeout","throttle","bind","_handleExpandTransition","_activeCollapsible","_activeTrigger","_activeContent","_activeId","_nextAriaExpandedState","_nextAriaHiddenState","_getCollapsibleData","trigger","contentId","content","style","scrollHeight","classList","add","requestAnimationFrame","_setIds","_setActiveCollapsible","_setActiveContent","_setNextVisibleState","_toggleCollapsible","fullHeightValue","_collapsePanel","_expandPanel","height","_this","remove","currentVisibleState","attr","Dropdown","_handleFirstTabClose","_handleLastTabClose","_handleArrowKeyPress","_handleClose","_handleEscapeKeyPress","_handleOffMenuClick","_activeDropdownId","_activeDropdownAttr","_activeDropdownMenuId","_activeDropdown","_activeDropdownMenu","_firstDropdownAction","_lastDropdownAction","_focusTrap","_activeDropdownActions","_allowFocusReturn","_dropdownContainerAttr","_dropdownTargetAttr","_dropdownMenuClassName","dropdownId","dropdownAttr","dropdown","dropdownTrigger","dropdownMenuId","dropdownMenu","dropdownMenuActions","_getDropdownActions","key","stopPropagation","_closeOpenDropdowns","_setActiveDropdownId","_setActiveDropdown","_setActiveDropdownMenu","_setVisibleState","_startActiveDropdownEvents","body","_handleReturnFocus","_closeActiveDropdown","action","_resetProperties","_this2","containerSelector","menuId","Modal","_handleOpenTransition","_handleCloseTransition","_handleOverlayClick","_activeModalTrigger","_activeModalAttr","_activeModal","_activeModalContent","_activeModalId","_activeModalContentSelector","_activeModalCloseTriggers","_originalPagePadding","_scrollbarOffset","modal","modalContent","_setActiveId","_setActiveModal","_setActiveModalContent","_setScrollbarOffset","_setScrollStop","_toggleVisibility","_setFocusableChildren","_setCloseTriggers","_startEvents","_closeActiveModal","_focusTrigger","_unsetScrollStop","_unsetScrollbarOffset","elements","_focusContent","scrollTop","_modalCache","isVisible","innerWidth","getBoundingClientRect","right","_scrollbarIsVisible","_getScrollbarOffset","originalPaddingRight","documentElement","Tooltip","_handleEvent","_activeTooltipBox","instanceId","_getTrigger","tooltip","_activeTooltip","_hasInlineClass","_alignTooltip","_startCloseEvents","_setHideState","_startOpenEvents","property","triggerSize","_getSize","tooltipSize","offset","Math","floor","contains","Collapsibles","_Collapsible","Dropdowns","_Dropdown","Undernet","Modals","_Modals","Tooltips","_Tooltips","_createFocusTrap","createFocusRing","listeningForKeydown","listenForKeyboard","listenForClick","focusRing","enableFocusRing","disableFocusRing"],"mappings":"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"}